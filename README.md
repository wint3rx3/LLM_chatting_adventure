# LLM 기반 채팅 어드벤처 게임

하드웨어와 게임 엔진의 발전 덕분에 과거에 비해 방대한 게임 볼륨 구현이 가능해졌습니다. 이에 힘입어 유저의 선택에 따라 다채로운 결말을 볼 수 있는 멀티 엔딩을 구성하는 게임도 많이 늘어났습니다. 대다수의 게임은 선택지를 고르는 방식을 채택하고 있지만, 이는 적절한 선택지를 마련해두지 않는다면 오히려 몰입감을 해치는 부작용도 가지고 있습니다. 이 문제를 해결하기 위해 **유저가 자연어의 형태로 판단을 작성**하면, 이를 LLM이 해석하여 선택의 결과를 보여주는 플레이 형태를 제안합니다.

## Quick Start (설치 및 실행)

### 1. 의존성 설치

```bash
pip install -r requirements.txt
```

### 2. 환경 변수 설정

`.env.example`을 복사하여 `.env` 파일을 만들고 Upstage API 키를 설정합니다.

```bash
cp .env.example .env
# .env 파일에서 UPSTAGE_API_KEY 수정
# API 키 발급: https://console.upstage.ai/
```

### 3. 실행 방법

```bash
python src/main.py
# http://localhost:8001 에서 플레이
```

## Rule & Architecture (룰 및 설계)

플레이어는 현재 상태와 속성을 가지고 있습니다. 현재 상태는 체력, 멘탈, 돈으로 구성되며 각각 최대 3개까지 보유할 수 있습니다. 이 중 **체력, 멘탈이 0이 되면 게임 오버**입니다. 돈이 0일 경우, 게임 오버가 되진 않지만 선택지 결정에 큰 제약이 걸리게 됩니다. 속성은 특정 인카운터에서 가장 이상적인 선택지를 고를 수 있는 조건이 되기도 하고, 불리하게 작용하기도 합니다. 속성 가젯은 인카운터를 해결해나가며 습득 혹은 상실할 수 있습니다.
<img width="1531" height="656" alt="image" src="https://github.com/user-attachments/assets/660700ce-2280-4562-b14b-901f0a3a6434" />
게임을 실행하면 랜덤한 인카운터가 발생하게 됩니다. 채팅창으로 구성된 인터페이스에서, 플레이어는 현재 상황에 대하여 본인의 결정을 자연어 형태로 입력합니다. 입력된 자연어 문장을 LLM이 해석하여 가장 가까운 시나리오를 진행하게 됩니다. 게임 오버가 될 때까지 해당 루프가 반복됩니다.
<br>
<br>
지금 인카운터를 해결해나가며 자신만의 서사를 만들어 보세요!

1. 랜덤 인카운터 발생 → 인카운터 정보 + 유저 채팅으로 프롬프트 작성
2. LLM 해석 → 유저의 자연어를 가장 가까운 선택지로 매핑
3. 검증 → 가젯 보유 여부 등 조건 검사 (예: 총기 면허 없이 권총 구매 불가)
4. 결과 적용 → 상태(체력, 멘탈, 돈) 및 가젯 변화 업데이트트
5. 반복 → 체력/멘탈 0이 될 시 게임오버

## File Directory (파일 구조)

```
src/
├── data/           # 인카운터, 가젯, 스토리, 이미지 데이터
├── game/           # 게임 엔진 (엔카운터, 플래그, 가젯, 리소스)
├── llm/            # LLM 선택지 매핑 (ChoiceMapper)
├── ui/             # 채팅 인터페이스
├── web/            # FastAPI 웹 서버
└── tools/          # 에피소드 분석 등 개발자 도구
```

## Expansion (확장)

시나리오 원고를 입력하면 AI가 인카운터와 필요 가젯을 자동으로 생성하는 에피소드 분석 도구가 포함되어 있습니다. 현재 PDF, txt 파일에서 Parsing하여 LLM이 DATA 내 JSON 파일을 수정하도록 되어있으나, 입력 파일 형식 다변화, 이미지 생성, 분기점 추가 등의 확장이 가능합니다.

```bash
python scripts/analyze_episode.py <원고_파일_경로>
```

## 참고

- **서울 2033** (2019, 반지하 게임즈)의 게임 구조를 차용하였습니다.
- Upatage AI Ambassador 2기 지원을 위한 토이 프로젝트로 제작하였습니다.
- 이외의 목적으로 사용하지 않으며, 코드 및 정보는 비공개 예정입니다.
